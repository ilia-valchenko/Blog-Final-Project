@model IEnumerable<MvcPL.Models.Post.PostViewModel>

@{
    ViewBag.Title = "Index";
}

@Scripts.Render("~/scripts/jquery-1.10.2.js")
@Scripts.Render("~/scripts/jquery.unobtrusive-ajax.js")

<p>
    @Html.ActionLink("Add new post", "Create")
</p>

    @foreach (var item in Model)
    {
        <article id=@item.Id.ToString()>
            <h3>Title: @item.Title</h3>
            <p><bold>Description: </bold>@item.Description</p>
            <p><small>Posted by: @item.Author.Nickname (Id: @item.Author.Id)</small></p>
            <p><small>Number of likes: <span id=@string.Format($"like{item.Id}")>@item.NumberOfLikes</span></small></p>
            <p><small>Number of comments: @item.NumberOfComments</small></p>
            <p><small id="pom">Date: </small>@item.PublishDate</p>
            <div>
                Tags:
                <ul>
                    @foreach (var tag in item.Tags)
                {
                        <li>@Html.RouteLink("#" + @tag.Name, "Hashtag", new { tagname = tag.Name })</li>
                    }
                </ul>
            </div>

            <div>
                @using (Ajax.BeginForm("Like", new AjaxOptions()
                {
                    UpdateTargetId = string.Format($"like{item.Id}"),
                    InsertionMode = InsertionMode.Replace
                }))
                {
                    <input type="hidden" name="id" value=@item.Id>
                    <input type="submit" value="Like">
                }
            </div>

            <ul>
                <li>@Html.ActionLink("Details", "Details", new { id = item.Id })</li>
                <!--Allows only for authorized users.-->
                <li>@Html.ActionLink("Edit", "Edit", new { id = item.Id })</li>
                <li>@Html.ActionLink("Delete", "Delete", new { id = item.Id })</li>
            </ul>

        </article>
    }